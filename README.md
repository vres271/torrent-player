# Torrent Player (VPN split routing)

Проект разворачивается "с нуля" через Docker Compose; единственное, что нужно добавить вручную — VPN-конфиг (WireGuard/AmneziaWG).

## Требования

- Docker и Docker Compose v2
- VPN-конфиг в формате `wg0.conf` (WireGuard/AmneziaWG)

## Установка

```bash
git clone <REPO_URL>
cd <repo>
```

## VPN-конфиг (обязательно)

Необходимо разместить конфиг в репозитории **локально** (файл приватный, в git не добавляется):

```
vpn-user-config/wg0.conf
```

Контейнеры используют этот конфиг для поднятия туннеля.

## Запуск

```bash
docker compose up -d
```

Остановка:

```bash
docker compose down
```

Просмотр логов:

```bash
docker compose logs -f
```

## Порты и доступ

- UI проекта: `http://localhost:8089`
- qBittorrent WebUI: `http://localhost:8081`

При изменении порта WebUI у qBittorrent необходимо также изменить проброс порта и переменную `WEBUI_PORT` на одно и то же значение (требование из-за особенностей CSRF/port mapping).

## Сетевая архитектура

- `amnezia-vpn` поднимает VPN и служит "сетевым пространством имён" для сервисов, которым нужен выход через VPN
- `vpn-app`, `torapi`, `dl-proxy` запускаются с `network_mode: service:amnezia-vpn`, поэтому их исходящий трафик идёт через VPN
- `normal-app` и `qbittorrent` работают вне VPN (напрямую)

## Загрузки торрентов

Все торренты скачиваются в папку `/torrents` (volume, примонтированный в контейнер), поэтому **скачанные файлы доступны на хост-машине** как обычные файлы.

Эту папку можно:

- Открывать и просматривать непосредственно на хосте (любой плеер/проводник)
- Расшарить по локальной сети (SMB/NFS/и т.п.) и воспроизводить с других устройств (ТВ, телефон через VLC)

Загрузка выполняется **последовательно по сегментам**, поэтому видео обычно можно начать просматривать через небольшой промежуток после старта скачивания, не дожидаясь завершения (при условии, что медиаплеер умеет воспроизводить файл в процессе дозагрузки).